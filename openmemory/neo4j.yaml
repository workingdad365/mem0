type: Microsoft.App/containerApps
name: neo4j
properties:
  environmentId: /subscriptions/dd0af5f8-3ec0-430f-bb4f-3c70732c41cc/resourceGroups/rg-az01-co001501-sbox-openmemory/providers/Microsoft.App/managedEnvironments/cae-openmemory-sbox-poc-11
  configuration:
    ingress:
      external: true
      allowInsecure: false
      targetPort: 7474
      transport: http
    activeRevisionsMode: single
  template:
    containers:
    - name: neo4j-server
      image: neo4j:latest
      env:
      - name: NEO4J_AUTH
        value: "neo4j/ktopenmemorypoc2025@1"
      resources:
        cpu: 1.0
        memory: 2.0Gi
      volumeMounts:
      - volumeName: neo4j-data-vol
        mountPath: /data
      - volumeName: neo4j-logs-vol
        mountPath: /logs
      - volumeName: neo4j-import-vol
        mountPath: /var/lib/neo4j/import
    scale:
      minReplicas: 1
      maxReplicas: 1
    volumes:
    - name: neo4j-data-vol
      storageType: AzureFile
      storageName: neo4jdata
      mountOptions: "dir_mode=0777,file_mode=0777,nobrl"
    - name: neo4j-logs-vol
      storageType: AzureFile
      storageName: neo4jlogs
      mountOptions: "dir_mode=0777,file_mode=0777,nobrl"
    - name: neo4j-import-vol
      storageType: AzureFile
      storageName: neo4jimport
      mountOptions: "dir_mode=0777,file_mode=0777,nobrl"
  identity:
    type: SystemAssigned
